generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://postgres:1234@localhost:5432/kofis_sms_db?schema=public"
}

model User {
  id       String @id @default(uuid())
  email    String @unique
  userName String @unique
  password String
}

model Student {
  id             String     @id @default(uuid())
  first_name     String
  last_name      String
  other_name     String?
  indexNumber    String     @unique
  dob            String
  admission_date String
  passport_url   String?
  guardian       Guardian[]
  gender         Gender
  address        String
  phone          String
  class_id       String
  class          Class      @relation(fields: [class_id], references: [id])
  age            String

  FeePayment FeePayment[]
}

model Class {
  id          String    @id @default(uuid())
  name        String
  description String?
  feeId       String
  fee         Fee       @relation(fields: [feeId], references: [id])
  students    Student[]
}

model Terms {
  id            String       @id @default(uuid())
  name          String
  startDate     DateTime
  accademicYear String
  endDate       DateTime
  FeePayment    FeePayment[]
}

model Subject {
  id          String  @id @default(uuid())
  name        String
  description String?
}

model Guardian {
  id           String  @id @default(uuid())
  name         String
  phone        String
  address      String
  title        String
  relationship String
  studentId    String
  student      Student @relation(fields: [studentId], references: [id], onDelete: Cascade)
}

model Fee {
  id         String       @id @default(uuid())
  feeName    String
  amount     Float
  FeePayment FeePayment[]
  Class      Class[]
}

model FeePayment {
  id        String   @id @default(uuid())
  amount    Float
  createdAt DateTime @default(now())
  termId    String
  studentId String
  method    String
  paidDate  DateTime
  feeId     String
  student   Student  @relation(fields: [studentId], references: [id], onDelete: NoAction)
  term      Terms    @relation(fields: [termId], references: [id], onDelete: Cascade)
  fee       Fee      @relation(fields: [feeId], references: [id], onDelete: Cascade)
}

enum Gender {
  Male
  Female
  Other
}
